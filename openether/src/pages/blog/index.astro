---
import Layout from '../../layouts/Layout.astro';
import Container from '../../components/common/Container.astro';
import Card from '../../components/common/Card.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout title="Blog">
  <Container>
    <h1 class="text-4xl font-heading font-bold py-12 text-text">Blog</h1>
    
    {posts.length === 0 ? (
      <p class="text-textMuted">No blog posts yet. Check back soon!</p>
    ) : (
      <div class="grid gap-6">
        {posts.map((post) => (
          <a href={`/blog/${post.slug}`}>
            <Card hover>
              <h2 class="text-xl font-bold mb-2 text-text">{post.data.title}</h2>
              <p class="text-textMuted mb-4">{post.data.description}</p>
              <time class="text-sm text-textMuted">
                {post.data.pubDate.toLocaleDateString('en-US', { dateStyle: 'long' })}
              </time>
              {post.data.tags.length > 0 && (
                <div class="flex gap-2 mt-3">
                  {post.data.tags.map((tag) => (
                    <span class="text-xs text-primary">#{tag}</span>
                  ))}
                </div>
              )}
            </Card>
          </a>
        ))}
      </div>
    )}
  </Container>
</Layout>
